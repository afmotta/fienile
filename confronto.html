<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Confronto Prospetti — Piano Terra + Primo Piano</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: #f5f2ed;
    font-family: 'DM Sans', sans-serif;
    color: #2a2520;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 40px 20px;
  }

  h1 {
    font-size: 1.1rem;
    font-weight: 500;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: #8a7e72;
    margin-bottom: 8px;
  }

  .subtitle {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.8rem;
    color: #b0a698;
    margin-bottom: 32px;
  }

  .controls {
    display: flex;
    gap: 32px;
    margin-bottom: 40px;
    flex-wrap: wrap;
    justify-content: center;
  }

  .control-group {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .control-group label {
    font-size: 0.75rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: #8a7e72;
  }

  select {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.8rem;
    padding: 8px 12px;
    border: 1px solid #d6cfc6;
    border-radius: 4px;
    background: #fff;
    color: #2a2520;
    cursor: pointer;
    min-width: 280px;
  }

  select:focus {
    outline: none;
    border-color: #5a8199;
  }

  .drawing-container {
    width: 100%;
    max-width: 1100px;
    overflow-x: auto;
  }

  .floor-label {
    font-size: 0.85rem;
    font-weight: 500;
    color: #5a8199;
    text-align: center;
    margin: 24px 0 8px;
  }

  .floor-label:first-of-type {
    margin-top: 0;
  }

  svg { display: block; margin: 0 auto; }

  .legend {
    display: flex;
    gap: 28px;
    margin-top: 32px;
    flex-wrap: wrap;
    justify-content: center;
  }
  .legend-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.78rem;
    color: #6b5e52;
  }
  .legend-swatch {
    width: 20px;
    height: 12px;
    border-radius: 2px;
    border: 1px solid rgba(0,0,0,0.1);
  }
</style>
</head>
<body>

<h1>Confronto Prospetti</h1>
<div class="subtitle">Piano Terra + Primo Piano — seleziona le varianti</div>

<div class="controls">
  <div class="control-group">
    <label>Primo Piano</label>
    <select id="sel-p1">
      <option value="p1d" selected>P1-D — F2/F3 = 200 cm (base)</option>
      <option value="p1c">P1-C — F2/F3 = 180 cm</option>
      <option value="p1b">P1-B — F2/F3 = 170 cm</option>
      <option value="p1a">P1-A — F2/F3 = 160 cm (minimo RAI)</option>
    </select>
  </div>
  <div class="control-group">
    <label>Piano Terra</label>
    <select id="sel-pt">
      <option value="attuale" selected>Attuale — 4×200, gap 1m/2m/1m</option>
      <option value="regolare">Regolare — 4×200, centrate</option>
      <option value="varA">Variante A — F1/F4 190, F2/F3 290</option>
      <option value="varB">Variante B — F1/F4 190×150, F2/F3 290×250</option>
      <option value="varC">Variante C — F1/F4 279.5×150, F2/F3 290×250</option>
    </select>
  </div>
</div>

<div class="drawing-container">
  <div class="floor-label">▲ Primo Piano</div>
  <div id="svg-p1"></div>
  <div class="floor-label" style="margin-top:16px;">▼ Piano Terra</div>
  <div id="svg-pt"></div>
</div>

<div class="legend">
  <div class="legend-item">
    <div class="legend-swatch" style="background:#e8e2d9; border-color:#2a2520;"></div>
    Muratura
  </div>
  <div class="legend-item">
    <div class="legend-swatch" style="background:#6b5e52;"></div>
    Pilastri (30 cm)
  </div>
  <div class="legend-item">
    <div class="legend-swatch" style="background:#c8dce8; border-color:#5a8199;"></div>
    Finestre / Porte finestre
  </div>
  <div class="legend-item">
    <div class="legend-swatch" style="background:#ddd5cb;"></div>
    Architrave (h 200)
  </div>
  <div class="legend-item">
    <svg width="20" height="12"><rect x="1" y="1" width="18" height="10" fill="none" stroke="#b0453a" stroke-width="1.2" stroke-dasharray="3,2" rx="1"/></svg>
    Colonna frontale (76 cm)
  </div>
</div>

<div style="text-align:center;margin:40px 0 20px;"><a href="./index.html" style="font-family:DM Sans,sans-serif;font-size:0.85rem;color:#5a8199;text-decoration:none;border:1px solid #d6cfc6;padding:10px 24px;border-radius:4px;transition:border-color 0.2s;">← Torna al menu</a></div>

<script>
// === CONSTANTS ===
const XOFF = 70, SCALE_H = 0.6385, SCALE_V = 0.8;
const WALL_W = 860, WALL_TOP = 40, WALL_BOT = 256, WALL_H = 216;
const WIN_TOP = 56; // y for top of windows (below architrave)

function cx(cm) { return XOFF + cm * SCALE_H; }
function cw(cm) { return cm * SCALE_H; }

// === VARIANT DATA ===

// Piano terra pillars (3 pillars)
const PT_PILLARS = [
  { pos: 309, w: 30 },
  { pos: 658.5, w: 30 },
  { pos: 1008, w: 30 }
];

// Primo piano pillars (2 pillars)
const P1_PILLARS = [
  { pos: 590, w: 30 },
  { pos: 727, w: 30 }
];

// Column (same for both)
const COLUMN = { pos: 635.5, w: 76 };

// Piano terra variants
const PT_VARIANTS = {
  attuale: {
    label: 'Attuale',
    windows: [
      { x: 73.5, w: 200, h: 250, sill: 0 },
      { x: 373.5, w: 200, h: 250, sill: 0 },
      { x: 773.5, w: 200, h: 250, sill: 0 },
      { x: 1073.5, w: 200, h: 250, sill: 0 }
    ]
  },
  regolare: {
    label: 'Regolare',
    windows: [
      { x: 73.5, w: 200, h: 250, sill: 0 },
      { x: 398.75, w: 200, h: 250, sill: 0 },
      { x: 748.25, w: 200, h: 250, sill: 0 },
      { x: 1073.5, w: 200, h: 250, sill: 0 }
    ]
  },
  varA: {
    label: 'Variante A',
    windows: [
      { x: 104.5, w: 190, h: 250, sill: 0 },
      { x: 353.75, w: 290, h: 250, sill: 0 },
      { x: 703.25, w: 290, h: 250, sill: 0 },
      { x: 1052.5, w: 190, h: 250, sill: 0 }
    ]
  },
  varB: {
    label: 'Variante B',
    windows: [
      { x: 104.5, w: 190, h: 150, sill: 100 },
      { x: 353.75, w: 290, h: 250, sill: 0 },
      { x: 703.25, w: 290, h: 250, sill: 0 },
      { x: 1052.5, w: 190, h: 150, sill: 100 }
    ]
  },
  varC: {
    label: 'Variante C',
    windows: [
      { x: 14.75, w: 279.5, h: 150, sill: 100 },
      { x: 353.75, w: 290, h: 250, sill: 0 },
      { x: 703.25, w: 290, h: 250, sill: 0 },
      { x: 1052.75, w: 279.5, h: 150, sill: 100 }
    ]
  }
};

// Primo piano variants
const P1_VARIANTS = {
  p1a: { label: 'P1-A', f2w: 160 },
  p1b: { label: 'P1-B', f2w: 170 },
  p1c: { label: 'P1-C', f2w: 180 },
  p1d: { label: 'P1-D', f2w: 200 }
};

function getP1Windows(f2w) {
  const f3x = 1347 - 250 - f2w;
  return [
    { x: 65, w: 60, h: 150, sill: 100 },
    { x: 250, w: f2w, h: 250, sill: 0 },
    { x: f3x, w: f2w, h: 250, sill: 0 },
    { x: 1222, w: 60, h: 150, sill: 100 }
  ];
}

// === SVG GENERATION ===

function generateSVG(pillars, windows, label, id, roomNames) {
  const uid = id; // unique prefix for patterns
  let svg = `<svg viewBox="0 0 980 300" xmlns="http://www.w3.org/2000/svg" width="980">`;

  // Defs
  svg += `<defs>
    <pattern id="colH${uid}" patternUnits="userSpaceOnUse" width="6" height="6" patternTransform="rotate(45)">
      <line x1="0" y1="0" x2="0" y2="6" stroke="#b0453a" stroke-width="0.4" opacity="0.6"/>
    </pattern>
  </defs>`;

  // Wall
  svg += `<rect x="${XOFF}" y="${WALL_TOP}" width="${WALL_W}" height="${WALL_H}" fill="#e8e2d9" rx="1"/>`;
  svg += `<rect x="${XOFF}" y="${WALL_TOP}" width="${WALL_W}" height="${WALL_H}" stroke="#2a2520" stroke-width="1.5" fill="none" rx="1"/>`;

  // Ground line + hatch
  svg += `<line x1="55" y1="${WALL_BOT}" x2="945" y2="${WALL_BOT}" stroke="#8a7e72" stroke-width="2"/>`;
  [60,75,90,105,900,915,930,945].forEach(x => {
    svg += `<line x1="${x}" y1="${WALL_BOT}" x2="${x-8}" y2="${WALL_BOT+8}" stroke="#b0a698" stroke-width="0.6"/>`;
  });

  // Pillars
  pillars.forEach(p => {
    const px = cx(p.pos), pw = cw(p.w);
    svg += `<rect x="${px}" y="36" width="${pw}" height="224" fill="#6b5e52" rx="1"/>`;
    svg += `<line x1="${px+2}" y1="36" x2="${px+pw-4}" y2="260" stroke="#7d6f62" stroke-width="0.5" opacity="0.3"/>`;
    svg += `<line x1="${px+7}" y1="36" x2="${px+pw-2}" y2="260" stroke="#7d6f62" stroke-width="0.5" opacity="0.3"/>`;
  });

  // Windows
  windows.forEach((win, i) => {
    const wx = cx(win.x), ww = cw(win.w);
    const sillPx = win.sill * SCALE_V;
    const hPx = win.h * SCALE_V;
    const wy = WALL_BOT - sillPx - hPx; // top of window
    const wyBot = WALL_BOT - sillPx;

    // Architrave
    svg += `<rect x="${wx}" y="${wy - 16}" width="${ww}" height="16" fill="#ddd5cb"/>`;

    // Window fill + stroke
    svg += `<rect x="${wx}" y="${wy}" width="${ww}" height="${hPx}" fill="#c8dce8"/>`;
    svg += `<rect x="${wx}" y="${wy}" width="${ww}" height="${hPx}" stroke="#5a8199" stroke-width="1.2" fill="none"/>`;

    // Mullions (for windows >= 150cm wide)
    if (win.w >= 150) {
      const third = ww / 3;
      svg += `<line x1="${wx+third}" y1="${wy}" x2="${wx+third}" y2="${wyBot}" stroke="#5a8199" stroke-width="0.8"/>`;
      svg += `<line x1="${wx+2*third}" y1="${wy}" x2="${wx+2*third}" y2="${wyBot}" stroke="#5a8199" stroke-width="0.8"/>`;
    }

    // Transoms
    if (win.h >= 200) {
      const seg = hPx / 3;
      svg += `<line x1="${wx}" y1="${wy+seg}" x2="${wx+ww}" y2="${wy+seg}" stroke="#5a8199" stroke-width="0.8"/>`;
      svg += `<line x1="${wx}" y1="${wy+2*seg}" x2="${wx+ww}" y2="${wy+2*seg}" stroke="#5a8199" stroke-width="0.8"/>`;
    } else {
      const mid = hPx / 2;
      svg += `<line x1="${wx}" y1="${wy+mid}" x2="${wx+ww}" y2="${wy+mid}" stroke="#5a8199" stroke-width="0.8"/>`;
    }

    // Architrave dashed line
    svg += `<line x1="${wx}" y1="${wy}" x2="${wx+ww}" y2="${wy}" stroke="#8a7e72" stroke-width="0.8" stroke-dasharray="2,2"/>`;

    // Sill line
    if (win.sill > 0) {
      svg += `<line x1="${wx-3}" y1="${wyBot}" x2="${wx+ww+3}" y2="${wyBot}" stroke="#6b5e52" stroke-width="1.2"/>`;
    }

    // Label
    const center = wx + ww/2;
    svg += `<text x="${center}" y="${wy - 22}" font-family="DM Sans, sans-serif" font-size="9" fill="#5a8199" text-anchor="middle" font-weight="500">F${i+1} — ${win.w}×${win.h}</text>`;
    if (roomNames && roomNames[i]) {
      svg += `<text x="${center}" y="${wy - 12}" font-family="DM Sans, sans-serif" font-size="7" fill="#8a7e72" text-anchor="middle">${roomNames[i]}</text>`;
    }
  });

  // Column (drawn after windows so it's visible on top)
  const colX = cx(COLUMN.pos), colW = cw(COLUMN.w);
  svg += `<rect x="${colX}" y="36" width="${colW}" height="224" fill="url(#colH${uid})" stroke="#b0453a" stroke-width="1.5" stroke-dasharray="6,4" rx="1"/>`;

  // Label at bottom
  svg += `<text x="500" y="290" font-family="JetBrains Mono, monospace" font-size="8" fill="#9a8d7f" text-anchor="middle">${label}</text>`;

  svg += `</svg>`;
  return svg;
}

function render() {
  const ptKey = document.getElementById('sel-pt').value;
  const p1Key = document.getElementById('sel-p1').value;

  const ptVar = PT_VARIANTS[ptKey];
  const p1Var = P1_VARIANTS[p1Key];

  document.getElementById('svg-p1').innerHTML = generateSVG(
    P1_PILLARS,
    getP1Windows(p1Var.f2w),
    `Primo Piano — ${p1Var.label} (F2/F3 = ${p1Var.f2w} cm)`,
    'p1',
    ['Bagno Nord', 'Camera Nord', 'Camera Sud', 'Bagno Sud']
  );

  document.getElementById('svg-pt').innerHTML = generateSVG(
    PT_PILLARS,
    ptVar.windows,
    `Piano Terra — ${ptVar.label}`,
    'pt',
    ['Cucina', 'Cucina', 'Soggiorno', 'Soggiorno']
  );
}

document.getElementById('sel-pt').addEventListener('change', render);
document.getElementById('sel-p1').addEventListener('change', render);
render();
</script>

</body>
</html>
